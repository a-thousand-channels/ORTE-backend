- content_for(:title) { "Import for #{@layer.title}" }

#table-wrapper
  %p.text-right.close_link_wrapper
    =link_to map_path(@map), :class=>'close_link' do
      %i.fi.fi-x
  %h1
    Import preview:
    = link_to map_layer_path(@map,@layer) do
      = @layer.title
  .grid-x.grid-padding-x
    .large-12.medium-12.small-12.cell
      %hr
      - if flash[:alert]
        .alert.alert-danger
          %p= flash[:alert]

      - if @invalid_rows.any?
        .alert.alert-danger
          %p Some rows in the CSV are invalid and cannot be imported. Please review the errors below.

      - if @valid_rows.any?
        %h2 Preview:
        %table.table.table-striped
          %thead
            %tr
              - Imports::CsvImporter::ALLOWED_FIELDS.each do |field|
                %th= field.capitalize
          %tbody
            - @valid_rows.each do |row|
              %tr
                - Imports::CsvImporter::ALLOWED_FIELDS.each do |field|
                  %td= row[field]

        = simple_form_for :import, url: importing_map_layer_path(@map), multipart: true, method: "POST", html: { class: 'form-inline' } do |f|
          = f.input :file, :input_html => { :value => params[:import][:file] }, label: false
          = hidden_field_tag :dry_run, false
          = button_tag(type: 'submit', class: 'button') do
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" style="vertical-align: -7px"><path d="M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z"></path></svg>
            Confirm Import

      - else
        %p No valid rows found.
